@using RepairEquipment.Client.Services
@using System.ComponentModel.DataAnnotations

    <MudCard>
        <MudCardContent>
           <MudForm @bind-IsValid="@success">

                @* Name *@
               <MudTextField T="string" Label="Name" Required="true" RequiredError="Name is required!" @bind-Value="Equipment.Name"/>

               @* Type *@
               <MudSelect Label="Type" Required="true" RequiredError="Type is required!" @bind-Value="_selectedEquipmentType">
                   @foreach (EquipmentTypeRecord type in EquipmentType)
                   {
                        <MudSelectItem Value="@type">@type.Name</MudSelectItem>
                   }
               </MudSelect>

               @* Location *@
               <MudSelect Label="Location" Required="true" RequiredError="Location is required!" @bind-Value="_selectedLocation">
                   @foreach (LocationRecord location in Location)
                   {
                        <MudSelectItem Value="@location">@location.Name</MudSelectItem>
                   }
               </MudSelect>

               @* SerialNumber *@
               <MudTextField T="string" Label="SerialNumber" Required="true" RequiredError="Serial number is required!" @bind-Value="Equipment.SerialNumber"/>
               
               @* FixedAssetNr *@ 
               <MudTextField T="int" Label="FixedAssetNr" Required="true" RequiredError="FixedAssetNr is required!" @bind-Value="Equipment.FixedAssetNr"/>

               @* PurchaseDate *@ 
               <MudDatePicker Label="dd.MM.yyyy" Editable="true" @bind-Date="Equipment.PurchaseDate" Mask="@(new DateMask("dd.MM.yyyy"))" DateFormat="dd.MM.yyyy"/>
       
               @* PurchaseSum *@ 
               <MudTextField T="decimal" Label="PurchaseSum" Required="true" RequiredError="Purchase sum is required!" @bind-Value="Equipment.PurchaseSum"/>
               
               @* PurchaseInvoiceNr *@ 
               <MudTextField T="string" Label="PurchaseInvoiceNr" Required="true" RequiredError="PurchaseInvoiceNr is required!" @bind-Value="Equipment.PurchaseInvoiceNr"/>

               @* PurchaseInvoiceLink *@ 
               <MudTextField T="string" Label="PurchaseInvoiceLink" Required="true" RequiredError="PurchaseInvoiceLink is required!" @bind-Value="Equipment.PurchaseInvoiceLink"/>

               @* DepreciationPeriod *@ 
               <MudTextField T="int" Label="DepreciationPeriod" Required="true" RequiredError="DepreciationPeriod is required!" @bind-Value="Equipment.DepreciationPeriod"/>

               @* Depreciation *@ 
               <MudTextField T="decimal" Label="DepreciationPeriod" Required="true" RequiredError="Depreciation is required!" @bind-Value="Equipment.Depreciation"/>
            
               @* Notes *@ 
               <MudTextField T="string" Label="Notes" @bind-Value="Equipment.Notes"/>               
               
            </MudForm>
        </MudCardContent>
        <MudCardActions>
            <MudButton OnClick="Cancel">Cancel</MudButton>
            <MudButton Color="Color.Primary" Disabled="@(!success)" OnClick="Submit">Ok</MudButton>
        </MudCardActions>
    </MudCard>


@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter] public EquipmentRecord Equipment { get; set; } = new EquipmentRecord();
    [Parameter] public static EquipmentTypeRecord? _selectedEquipmentType { get; set; }
    [Parameter] public static LocationRecord? _selectedLocation { get; set; }
    [Parameter] public List<EquipmentTypeRecord> EquipmentType { get; set; }
    [Parameter] public List<LocationRecord> Location { get; set; }
    
    bool success;
    

    void Submit() => MudDialog.Close(DialogResult.Ok(Equipment));
    void Cancel() => MudDialog.Cancel();

}