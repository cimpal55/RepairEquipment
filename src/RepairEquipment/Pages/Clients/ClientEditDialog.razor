@using RepairEquipment.Client.Services
@using System.ComponentModel.DataAnnotations

<MudDialog>
	<DialogContent>
		<MudForm @bind-IsValid="@success">
            <MudItem xs="12" sm="6" md="12">
                <MudGrid Spacing="0">

                    @* Name *@
                    <MudTextField T="string" Label="Name" Required="true" RequiredError="Name is required!" @bind-Value="Client.Name" />

                    @* Surname *@
                    <MudTextField T="string" Label="Surname" Required="true" RequiredError="Surname is required!" @bind-Value="Client.Surname" />

                    @* Code *@
                    <MudTextField T="string" Label="Code" Required="true" RequiredError="Code is required!" @bind-Value="Client.Code" />

                    @* PersonalCode *@
                    <MudTextField T="string" Label="PersonalCode" Validation="@(new RegularExpressionAttribute("^[0-9]{6}-[0-9]{5}$") { ErrorMessage = "Personal code is incorrect" })"
                                  Required="true" RequiredError="Personal code is required!" @bind-Value="Client.PersonalCode" />
                    @* Phone *@
                    <MudTextField T="string" Label="Phone" Required="true" RequiredError="Phone is required!" @bind-Value="Client.Phone" />

                    @* Email *@
                    <MudTextField T="string" Label="Email" Validation="@(new EmailAddressAttribute() { ErrorMessage = "The email address is invalid"} )"
                                  @bind-Value="Client.Email" Required="true" RequiredError="Email is required!" />

                    @* ContactPersonName *@
                    <MudTextField T="string" Label="ContactPersonName" Required="true" RequiredError="Contact name is required!" @bind-Value="Client.ContactPersonName" />

                    @* ContactPersonAddress *@
                    <MudTextField T="string" Label="ContactPersonAddress" Required="true" RequiredError="Contact address is required!" @bind-Value="Client.ContactPersonAddress" />                    

                    @* ContactPersonPhone *@
                    <MudTextField T="string" Label="ContactPersonPhone" Required="true" RequiredError="Contact phone is required!" @bind-Value="Client.ContactPersonPhone" />
                    
                    @* ContactPersonEmail *@
                    <MudTextField T="string" Label="ContactPersonEmail" Required="true" RequiredError="Contact email is required!" @bind-Value="Client.ContactPersonEmail" />                       

                </MudGrid>
            </MudItem>
        </MudForm>
	</DialogContent>

    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Color="Color.Primary" Disabled="@(!success)" OnClick="Submit">Ok</MudButton>
    </DialogActions>

</MudDialog>

        
@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter] public ClientRecord Client { get; set; } = new ClientRecord();
    bool success;

    void Submit() => MudDialog.Close(DialogResult.Ok(Client));
    void Cancel() => MudDialog.Cancel();
}